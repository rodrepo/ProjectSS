@model ProjectSS.Web.Models.BudgetRequestViewModel
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h3>
    New Budget Request
    <div class="pull-right">
        <a id="button1" type="Submit" class="btn btn-success" href="#">
            Submit
        </a>
        <a type="button" class="btn btn-info" href="@Url.Action("Show", "Project", new {@id = Model.ProjectId })">
            Back
        </a>
    </div>
    <ol class="breadcrumb">
        <li>
            <a href="/Home">Home</a>
        </li>
        <li>
            <a href="/Project">Projects</a>
        </li>
        <li>
            <a href="@Url.Action("Show", "Project", new {@id = Model.ProjectId })">@Model.ProjectNumber</a>
        </li>
        <li class="active">New</li>
    </ol>
</h3>

<div class="row">
    @using (Html.BeginForm("Index", "BudgetRequest", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        for (int i = 0; i < Model.Items.Count; i++)
        {
            @Html.HiddenFor(model => Model.Items[i].Category)
            @Html.HiddenFor(model => Model.Items[i].Item)
            @Html.HiddenFor(model => Model.Items[i].Description)
            @Html.HiddenFor(model => Model.Items[i].Amount)
        }
        @Html.HiddenFor(m => m.ProjectNumber)
        @Html.HiddenFor(m => m.ProjectId)
        @Html.HiddenFor(m => m.IsCreate)
        <button type="submit" class="hidden" id="button2"></button>

        <div class="col-lg-8">
            <!-- START panel-->
            <div class="panel panel-default">
                <div class="panel-heading">
                </div>
                <div class="panel-body">
                    <div class="form-group col-sm-6" style="padding-left:0">
                        <label>Purpose</label>
                        @Html.TextBoxFor(model => model.Purpose, new { @class = "form-control", @type = "text", @required = "required" })
                    </div>
                    <div class="form-group col-sm-6" style="padding:0">
                        <label>Date Needed</label>
                        @Html.TextBoxFor(model => model.DateNeeded, new { @class = "form-control" })
                    </div>
                </div>
            </div>
            <!-- START panel-->
            <div class="panel panel-default">
                <div class="panel-heading">
                </div>
                <div class="panel-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Item</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Items)
                                {
                                    <tr>
                                        <td>@item.Category</td>
                                        <td>@item.Item</td>
                                        <td>@item.Description</td>
                                        <td>@item.Amount</td>
                                        <td>
                                            <button type="submit" id="@item.Description" class="btn btn-danger btn-xs"></button>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        <br />
                        <div>
                            Total:
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <!-- START panel-->
            <div class="panel panel-default">
                <div class="panel-heading">
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        <label>Category</label>
                        <select name="account" class="form-control m-b">
                            <option>Option 1</option>
                            <option>Option 2</option>
                            <option>Option 3</option>
                            <option>Option 4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Item</label>
                        <select name="account" class="form-control m-b">
                            <option>Option 1</option>
                            <option>Option 2</option>
                            <option>Option 3</option>
                            <option>Option 4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        @Html.TextAreaFor(model => model.Item.Description, new { @class = "form-control", @row = "4" })
                    </div>
                    <div class="form-group">
                        <button id="addItem" type="submit" class="mb-xl btn btn-success col-sm-12">Add Item</button>
                    </div>
                </div>
            </div>
        </div>
    }
</div>
@section Styles {
    @Styles.Render("~/bundles/datatablesCss")
}
@section Scripts {
    @Scripts.Render("~/bundles/datatables")
    @Scripts.Render("~/bundles/demoDatatable")
    <script type="text/javascript">
            $(document).ready(function () {
                if ('@TempData["Error"]' != "") {
                    $.notify('@TempData["Error"]', "danger");
                }
                if ('@TempData["Success"]' != "") {
                    $.notify('@TempData["Success"]', "success");
                }
                if ('@TempData["Info"]' != "") {
                    $.notify('@TempData["Info"]', "info");
                }
                if ('@TempData["Warning"]' != "") {
                    $.notify('@TempData["Warning"]', "warning");
                }
            });
    </script>
   <script type="text/javascript">
           $('#button1').click(function () {
               $("#IsCreate").val("true")
               $("#button2").click();
           });
           $('#deleteItem').click(function () {
               $("#IsCreate").val("delete")
           });
   </script>
    <script type="text/javascript">
                $('#addItem').click(function () {
                    $("#IsCreate").val("addItem")
                });
    </script>
    @foreach (var item in Model.Items)
    {
        <script type="text/javascript">
            var id = '#@item.Description';
            var val = '@item.Description';
            $(id).click(function () {
                $("#IsCreate").val(val)
            });
        </script>
    }

}